(this["webpackJsonp@devias-io/material-kit-pro-react"]=this["webpackJsonp@devias-io/material-kit-pro-react"]||[]).push([[15],{1285:function(e,t,a){"use strict";a.r(t);var n=a(68),r=a.n(n),c=a(99),o=a(299),i=a(28),s=a(76),l=a(0),u=a.n(l),d=a(220),m=a.n(d),f=a(1043),p=a(997),h=a(1045),b=a(1046),v=a(1047),g=a(1048),E=a(163),k=a(50),y=a(460),O=a(24),j=a(850),C=a(895),S=a(218),w=a(898),D=(a(1049),a(1050),a(1051),a(1052),a(32)),x=a(908),T=a(284),N=a(19),A=a(2),_=a(896),B=a(847),P=a(881),I=a(207),W=a(1249),V=Object(y.a)((function(e){return{root:{},action:{marginBottom:e.spacing(1),"& + &":{marginLeft:e.spacing(1)}},actionIcon:{marginRight:e.spacing(1)}}}));function M(e){var t=e.className,a=e.onEventAdd,n=Object(N.a)(e,["className","onEventAdd"]),r=V();return u.a.createElement(_.a,Object.assign({className:Object(A.a)(r.root,t),container:!0,justify:"space-between",spacing:3},n),u.a.createElement(_.a,{item:!0},u.a.createElement(B.a,{variant:"h3",color:"textPrimary"},"Here's what you planned")),u.a.createElement(_.a,{item:!0},u.a.createElement(P.a,{color:"secondary",variant:"contained",onClick:a,className:r.action},u.a.createElement(I.a,{fontSize:"small",className:r.actionIcon},u.a.createElement(W.a,null)),"New Socket")))}M.defaultProps={onEventAdd:function(){}};var R=M,F=a(1250),G=a(901),L=a(888),z=a(889),Y=a(1053),H=a.n(Y),U=a(1054),q=a.n(U),J=[{label:"Month",value:"dayGridMonth",icon:H.a},{label:"Week",value:"timeGridWeek",icon:q.a}],K=Object(y.a)((function(){return{root:{}}}));var Q=function(e){var t=e.date,a=e.view,n=e.onDatePrev,r=e.onDateNext,c=(e.onEventAdd,e.onViewChange),o=e.onDateToday,i=e.className,s=Object(N.a)(e,["date","view","onDatePrev","onDateNext","onEventAdd","onViewChange","onDateToday","className"]),l=K();return u.a.createElement(_.a,Object.assign({className:Object(A.a)(l.root,i)},s,{alignItems:"center",container:!0,justify:"space-between",spacing:3}),u.a.createElement(_.a,{item:!0},u.a.createElement(F.a,{size:"small"},u.a.createElement(P.a,{onClick:n},"Prev"),u.a.createElement(P.a,{onClick:o},"Today"),u.a.createElement(P.a,{onClick:r},"Next"))),u.a.createElement(G.a,{smDown:!0},u.a.createElement(_.a,{item:!0},u.a.createElement(B.a,{variant:"h3",color:"textPrimary"},m()(t).format("MMMM YYYY"))),u.a.createElement(_.a,{item:!0},J.map((function(e){var t=e.icon;return u.a.createElement(L.a,{key:e.value,title:e.label},u.a.createElement(z.a,{color:e.value===a?"secondary":"default",onClick:function(){return c(e.value)}},u.a.createElement(t,null)))})))))},X=a(1252),Z=a(931),$=a(932),ee=a(849),te=a(848),ae=a(996),ne=a(904),re=a(990),ce=a(861),oe=a(884),ie=a(891),se=a(1277),le=a(1055),ue=a(926),de=Object(y.a)((function(e){return{root:{},confirmButton:{marginLeft:e.spacing(2)}}}));function me(e){var t=e.event,a=e.mode,n=e.onAdd,o=e.onCancel,i=e.onDelete,l=e.onEdit,d=Object(E.useSnackbar)().enqueueSnackbar,f=Object(k.c)((function(e){return e.account})).user,p=t.suscriptors||[],h=de(),b=function(){return"USER_ROLE"===f.role?u.a.createElement($.a,{initialValues:{start:t.start||8520768e5,id:t._id||null},onSubmit:function(){var e=Object(c.a)(r.a.mark((function e(t,n){var c,o,i,u,m;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=n.resetForm,o=n.setErrors,i=n.setStatus,u=n.setSubmitting,e.prev=1,m=Object(s.a)({},t),e.next=5,Object(ue.a)(200);case 5:"edit"===a?D.a.patch("".concat("http://localhost:3001","/calendar/events/").concat(m.id)).then((function(e){e.status,console.log(e),d("Sub success",{variant:"success"})})).catch((function(e){e.response&&d("You are already subscribe, ".concat(f.username,"!"),{variant:"error"})})):d("Can't do this, ".concat(f.username,"!"),{variant:"error"}),c(),i({success:!0}),u(!1),"edit"===a&&l(m),e.next=18;break;case 12:e.prev=12,e.t0=e.catch(1),i({success:!1}),o({submit:e.t0.message}),u(!1),d("Can't save nothing",{variant:"error"});case 18:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t,a){return e.apply(this,arguments)}}()},(function(e){var n=e.errors,r=e.handleSubmit,c=e.isSubmitting,s=e.setFieldTouched,l=e.setFieldValue,d=e.touched,m=e.values;return u.a.createElement("form",{onSubmit:r},u.a.createElement(w.a,{p:3},u.a.createElement(B.a,{align:"center",gutterBottom:!0,variant:"h3",color:"textPrimary"},"Subscribe \ud83d\ude00")),u.a.createElement(w.a,{p:3},u.a.createElement(w.a,{mt:2},u.a.createElement(se.a,{fullWidth:!0,inputVariant:"outlined",label:"Date",name:"start",onClick:function(){return s("end")},onChange:function(e){return l("start",e)},value:m.start,minutesStep:60,disablePast:"false",readOnly:!0})),u.a.createElement(w.a,{mt:2},u.a.createElement(ee.a,{dense:!0,className:h.root},Object.values(p).map((function(e,t){return u.a.createElement(te.a,{key:t,button:!0},u.a.createElement(ae.a,null,u.a.createElement(ne.a,{className:h.avatar,src:e.avatar})),u.a.createElement(re.a,{primary:"".concat(e.username," has suscribed")}))})))),Boolean(d.end&&n.end)&&u.a.createElement(w.a,{mt:2},u.a.createElement(ce.a,{error:!0},n.end))),u.a.createElement(oe.a,null),u.a.createElement(w.a,{p:2,display:"flex",alignItems:"center"},"edit"===a&&u.a.createElement(P.a,{variant:"contained",color:"secondary",className:h.confirmButton,onClick:function(){return i(t._id)}},"UnSubscribe"),u.a.createElement(w.a,{flexGrow:1}),u.a.createElement(P.a,{onClick:o},"Cancel"),u.a.createElement(P.a,{variant:"contained",type:"submit",disabled:c,color:"secondary",className:h.confirmButton},"Subscribe")))})):u.a.createElement($.a,{initialValues:{color:t.color||"",limit:t.limit||"",end:t.end||m()(),start:t.start||8520768e5,title:t.title||"",id:t._id||null},validationSchema:Z.b().shape({limit:Z.d().max(3)}),onSubmit:function(){var e=Object(c.a)(r.a.mark((function e(t,c){var o,i,u,m,p,h,b,v;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=c.resetForm,i=c.setErrors,u=c.setStatus,m=c.setSubmitting,e.prev=1,p=Object(s.a)({},t),console.log(p),e.next=6,Object(ue.a)(200);case 6:h="Bearer "+window.localStorage.getItem("accessToken"),"add"===a?(b=new Date(p.start),v=new Date(p.end),console.log(p.start),p.start=b.getTime(),p.end=v.getTime(),console.log(p.limit),D.a.post("".concat("http://localhost:3001","/calendar/events"),p,{headers:{accessToken:h}}).then((function(e){e.status,console.log(e),d("Save Success",{variant:"success"})})).catch((function(e){e.response&&d("Can't do this, ".concat(f.username,"!"),{variant:"error"})}))):(console.log(p.start),D.a.patch("".concat("http://localhost:3001","/calendar/events"),p,{headers:{accessToken:h}}).then((function(e){e.status,console.log(e),d("Save Success",{variant:"success"})})).catch((function(e){e.response&&d("Can't do this, ".concat(f.username,"!"),{variant:"error"})}))),o(),u({success:!0}),m(!1),"add"===a?n(p):l(p),e.next=20;break;case 14:e.prev=14,e.t0=e.catch(1),u({success:!1}),i({submit:e.t0.message}),m(!1),d("Can't save nothing",{variant:"error"});case 20:case"end":return e.stop()}}),e,null,[[1,14]])})));return function(t,a){return e.apply(this,arguments)}}()},(function(e){var n=e.errors,r=e.handleBlur,c=e.handleChange,s=e.handleSubmit,l=e.isSubmitting,d=e.setFieldTouched,m=e.setFieldValue,f=e.touched,b=e.values;return u.a.createElement("form",{onSubmit:s},u.a.createElement(w.a,{p:3},u.a.createElement(B.a,{align:"center",gutterBottom:!0,variant:"h3",color:"textPrimary"}),u.a.createElement(B.a,{align:"center",gutterBottom:!0,variant:"h3",color:"textPrimary"},"add"===a?"Add block hour \u23f0":"Edit block hour \u23f0")),u.a.createElement(w.a,{p:3},u.a.createElement(w.a,{mt:2},u.a.createElement(ie.a,{error:Boolean(f.limit&&n.limit),fullWidth:!0,helperText:f.limit&&n.limit,label:"Limit",name:"limit",onBlur:r,onChange:c,variant:"outlined"})),u.a.createElement(w.a,{mt:2}),u.a.createElement(w.a,{mt:2},u.a.createElement(se.a,{fullWidth:!0,inputVariant:"outlined",label:"Socket Start",name:"start",onClick:function(){return d("end")},onChange:function(e){return m("start",e)},value:b.start,minutesStep:60,disablePast:"false"})),u.a.createElement(w.a,{mt:2},u.a.createElement(ee.a,{dense:!0,className:h.root},Object.values(p).map((function(e,t){return u.a.createElement(te.a,{key:t,button:!0},u.a.createElement(ae.a,null,u.a.createElement(ne.a,{className:h.avatar,src:e.avatar})),u.a.createElement(re.a,{primary:"".concat(e.username," has suscribed")}))})))),Boolean(f.end&&n.end)&&u.a.createElement(w.a,{mt:2},u.a.createElement(ce.a,{error:!0},n.end))),u.a.createElement(oe.a,null),u.a.createElement(w.a,{p:2,display:"flex",alignItems:"center"},"edit"===a&&u.a.createElement(z.a,{onClick:function(){return i(t._id)}},u.a.createElement(I.a,null,u.a.createElement(le.a,null))),u.a.createElement(w.a,{flexGrow:1}),u.a.createElement(P.a,{onClick:o},"Cancel"),u.a.createElement(P.a,{variant:"contained",type:"submit",disabled:l,color:"secondary",className:h.confirmButton},"Confirm")))}))};return u.a.createElement(b,null)}me.defaultProps={event:{},onAdd:function(){},onCancel:function(){},onDelete:function(){},onEdit:function(){}};var fe=me;function pe(e){var t=e.event,a=e.mode,n=e.onAdd,r=e.onCancel,c=e.onDelete,o=e.onEdit,i=e.open,s=Object(N.a)(e,["event","mode","onAdd","onCancel","onDelete","onEdit","open"]);return u.a.createElement(X.a,Object.assign({maxWidth:"sm",fullWidth:!0,onClose:r,open:i},s),i&&u.a.createElement(fe,{event:t,mode:a,onAdd:n,onCancel:r,onDelete:c,onEdit:o}))}pe.defaultProps={event:{},onAdd:function(){},onCancel:function(){},onDelete:function(){},onEdit:function(){},open:!1};var he=pe,be=Object(y.a)((function(e){return{root:{backgroundColor:e.palette.background.dark,minHeight:"100%",paddingTop:e.spacing(3),paddingBottom:e.spacing(3)},calendar:{"& .fc-unthemed .fc-list-item:hover td":{backgroundColor:e.palette.background.dark},"& .fc-time-grid .fc-slats td":{contentHeight:"auto",height:"3em"},"& .fc-unthemed .fc-divider":{backgroundColor:e.palette.background.dark},"& .fc-unthemed .fc-popover .fc-header":{backgroundColor:e.palette.background.dark},"& .fc-unthemed .fc-list-heading td":{backgroundColor:e.palette.background.dark},"& .fc-unthemed th":{borderColor:e.palette.divider},"& .fc-unthemed td":{borderColor:e.palette.divider},"& .fc-unthemed td.fc-today":{backgroundColor:e.palette.background.dark},"& .fc-head":{backgroundColor:e.palette.background.dark},"& .fc-body":{backgroundColor:e.palette.background.default},"& .fc-axis":Object(s.a)({},e.typography.body2),"& .fc-list-item-time":Object(s.a)({},e.typography.body2),"& .fc-list-item-title":Object(s.a)({},e.typography.body1),"& .fc-list-heading-main":Object(s.a)({},e.typography.h6),"& .fc-list-heading-alt":Object(s.a)({},e.typography.h6),"& .fc th":{borderColor:e.palette.divider},"& .fc-day-header":Object(s.a)({},e.typography.subtitle2,{fontWeight:e.typography.fontWeightMedium,color:e.palette.text.secondary,padding:e.spacing(1),backgroundColor:e.palette.background.dark}),"& .fc-day-top":Object(s.a)({},e.typography.body2),"& .fc-highlight":{backgroundColor:e.palette.background.dark},"& .fc-event":{backgroundColor:e.palette.secondary.main,color:e.palette.secondary.contrastText,borderWidth:2,opacity:.9,"& .fc-time":Object(s.a)({},e.typography.h6,{color:"inherit"}),"& .fc-title":Object(s.a)({},e.typography.body1,{color:"inherit"})},"& .fc-list-empty":Object(s.a)({},e.typography.subtitle1)}}}));t.default=function(){var e=be(),t=Object(l.useRef)(null),a=Object(x.a)(),n=Object(O.a)(),d=Object(j.a)(n.breakpoints.down("sm")),y=Object(l.useState)("dayGridMonth"),N=Object(i.a)(y,2),A=N[0],_=N[1],B=Object(l.useState)(m()().toDate()),P=Object(i.a)(B,2),I=P[0],W=P[1],V=Object(l.useState)(null),M=Object(i.a)(V,2),F=M[0],G=M[1],L=Object(l.useState)({event:null,mode:null,open:!1}),z=Object(i.a)(L,2),Y=z[0],H=z[1],U=Object(E.useSnackbar)().enqueueSnackbar,q=Object(k.c)((function(e){return e.account})).user,J=function(){H({event:null,mode:null,open:!1})},K=Object(l.useCallback)(Object(c.a)(r.a.mark((function e(){var t,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="Bearer "+window.localStorage.getItem("accessToken"),e.next=3,D.a.get("".concat("http://localhost:3001","/calendars"),{headers:{accessToken:t}});case 3:n=e.sent,a.current&&G(n.data.events);case 5:case"end":return e.stop()}}),e)}))),[a]);return Object(l.useEffect)((function(){K()}),[K]),Object(l.useEffect)((function(){var e=t.current;if(e){e.getApi().changeView("timeGridWeek"),_("timeGridWeek")}}),[d]),F?u.a.createElement(T.a,{className:e.root,title:"Calendar"},u.a.createElement(C.a,{maxWidth:!1},u.a.createElement(R,{onEventAdd:function(){H({mode:"add",open:!0,event:{description:"",end:m()().add(30,"minutes").toDate(),start:m()().toDate(),title:"",_id:""}})}}),u.a.createElement(Q,{date:I,onDateNext:function(){var e=t.current;if(e){var a=e.getApi();a.next(),W(a.getDate())}},onDatePrev:function(){var e=t.current;if(e){var a=e.getApi();a.prev(),W(a.getDate())}},onDateToday:function(){var e=t.current;if(e){var a=e.getApi();a.today(),W(a.getDate())}},onViewChange:function(e){var a=t.current;a&&(a.getApi().changeView(e),_(e))},view:A}),u.a.createElement(S.a,{className:e.calendar,component:w.a,mt:3,p:2},u.a.createElement(f.a,{defaultDate:I,defaultView:A,droppable:!0,editable:!0,eventClick:function(e){var t="Bearer "+window.localStorage.getItem("accessToken");D.a.get("".concat("http://localhost:3001","/accounts/me"),{headers:{accessToken:t}}).then((function(t){var a=F.find((function(t){return t._id===e.event._def.extendedProps._id}));H({event:Object(s.a)({},a),mode:"edit",open:!0})})).catch((function(e){console.log(e)}))},eventDrop:function(e){var t=e.event,a={id:t._def.extendedProps._id,start:t.start},n="Bearer "+window.localStorage.getItem("accessToken");t.start>Date.now()?D.a.patch("".concat("http://localhost:3001","/calendars/events"),a,{headers:{accessToken:n}}).then((function(e){e.status,U("Edit Success",{variant:"success"})})).catch((function(e){e.response&&U("Can't edit this, ".concat(q.username),{variant:"error"})})):U("Can't edit this, ".concat(q.username),{variant:"error"}),G((function(e){return e.map((function(e){return e._id===t._id?Object(s.a)({},e,{start:Date.parse(t.start),end:Date.parse(t.start)+36e5}):e}))})),G(K()),K()},eventLimit:!0,eventResizableFromStart:!0,eventResize:function(e){var t=e.event,a=(t.end-t.start)/36e5;console.log(a);for(var n="Bearer "+window.localStorage.getItem("accessToken"),r=function(e){var r={limit:t._def.extendedProps.limit,start:e};D.a.post("".concat("http://localhost:3001","/calendars/events"),r,{headers:{accessToken:n}}).then((function(n){e===Date.parse(t.end)-36e5&&(n.status,U("Resize Success hours created: ".concat(a),{variant:"success"}))})).catch((function(a){e===Date.parse(t.end)-36e5&&a.response&&U("Can't resize this, ".concat(q.username,"!"),{variant:"error"})}))},c=Date.parse(t.start)+36e5;c<Date.parse(t.end);c+=36e5)r(c);G(K()),K()},events:F,header:!1,height:800,weight:50,ref:t,rerenderDelay:10,select:function(e){if("ADMIN_ROLE"===q.role){var a=t.current;if(a)a.getApi().unselect();H({event:{_id:e._id,description:"",end:e.end,start:e.start,title:""},mode:"add",open:!0})}},selectable:!0,weekends:!0,allDaySlot:!1,slotDuration:"01:00:00",plugins:[p.d,h.a,b.a,v.a,g.a]})),u.a.createElement(he,{event:Y.event,mode:Y.mode,onAdd:function(e){G((function(t){return[].concat(Object(o.a)(t),[e])})),J(),G(K()),K()},onCancel:function(){J()},onDelete:function(e){var t="Bearer "+window.localStorage.getItem("accessToken");"ADMIN_ROLE"===q.role?D.a.delete("".concat("http://localhost:3001","/calendars/events"),{data:{_id:e},headers:{accessToken:t}}).then((function(e){e.status,U("Delete Success",{variant:"success"})})).catch((function(e){e.response&&U("Can't Delete this, ".concat(q.username,"!"),{variant:"error"})})):(console.log(q.role),D.a.delete("".concat("http://localhost:3001","/calendars/events/").concat(e)).then((function(e){e.status,console.log(e),U("Unsub success",{variant:"success"})})).catch((function(e){e.response&&U("You are already unsubscribed, ".concat(q.username,"!"),{variant:"error"})}))),J(),G(K()),K()},onEdit:function(e){G((function(t){return t.map((function(t){return t._id===e._id?e:t}))})),J(),K()},open:Y.open}))):null}},908:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(0);function r(){var e=Object(n.useRef)(!0);return Object(n.useEffect)((function(){return function(){e.current=!1}}),[]),e}},926:function(e,t,a){"use strict";t.a=function(e){return new Promise((function(t){return setTimeout(t,e)}))}}}]);
//# sourceMappingURL=15.0d41d8fd.chunk.js.map